-------------------------------------------------------------------------------------------
File: /root/LLVM/mysql-8.0.36/storage/myisam/ha_myisam.cc
Function: ha_myisam::start_bulk_insert
    start_bulk_insert(rows)
    rows        Rows to be inserted
                0 if we don't know

  NOTICE
    Do not forget to call end_bulk_insert() later!
*/

void ha_myisam::start_bulk_insert(ha_rows rows) {
  DBUG_TRACE;
  THD *thd = current_thd;

  can_enable_indexes =
      mi_is_all_keys_active(file->s->state.key_map, file->s->base.keys);

  /*
    Only disable old index if the table was empty and we are inserting
    a lot of rows.
    Note that in end_bulk_insert() we may truncate the table if
    enable_indexes() failed, thus it's essential that indexes are
    disabled ONLY for an empty table.
  */
  if (file->state->records == 0 && can_enable_indexes &&
      (!rows || rows >= MI_MIN_ROWS_TO_DISABLE_INDEXES))
    mi_disable_non_unique_index(file, rows);
  else if (!file->bulk_insert &&
           (!rows || rows >= MI_MIN_ROWS_TO_USE_BULK_INSERT)) {
    mi_init_bulk_insert(file, thd->variables.bulk_insert_buff_size, rows);
  }
}


